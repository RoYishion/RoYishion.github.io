<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        table {
            width: 800px;
            border: 2px solid blue;
            margin: 0 auto;
            border-collapse: separate;
            border-spacing: 0;
        }

        td,th{
            border: thin solid blue;
            padding: 10px;
            text-align: center;
        }

        #app {
            width: 800px;
            margin: 0 auto;
        }

        tbody tr:hover{
            background-color:antiquewhite
        }

        #content {
            margin: 0 auto;
            width: 1004px;
        }

        #left, #right {
            border: 2px solid blue;
        }

        #left {
            width: 200px;
            float: left;
        }

        #right {
            width: 800px;
            float: right;
        }
    </style>
</head>

<body>
    <div id="content">
        <div id="left">
            <ul>
                <li @click="menuAction(1)">我的书籍</li>
                <li @click="menuAction(2)">我的地址</li>
            </ul>
        </div>

        <div id="right">
            <component :is="showCom"></component>
        </div>
    </div>
</body>

<template id="my-table">
    <div>
        <table>
            <thead>
                <th v-for="(value,key,index) in tableHead">{{value}}</th>
            </thead>
            <tbody>
                <tr v-for="(item,key1,index1) in tableBody">
                    <td v-for="(value2,key2,index2) in tableHead">{{item[key2]}}</td>
                    <td>
                        <slot name="item" :item="item">无操作</slot>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</template>

<template id="my-book">
    <div>
        <h2>书籍列表</h2>
        <my-table-component1 
        v-bind:table-head="bookHead"
        v-bind:table-body="books"
        >

        <template v-slot:item="slotProps">
            <input type="button" value="删除" @click="delBook(slotProps.item)">
        </template>
        </my-table-component1>
    </div>
</template>

<template id="my-address">
    <div>
        <h2>地址列表</h2>
        <my-table-component2 
        v-bind:table-head="addressHead"
        v-bind:table-body="address"
        >

        <template v-slot:item="slotProps">
            <input type="button" value="删除" @click="delAddress(slotProps.item)">
        </template>
        </my-table-component2>
    </div>
</template>

<script src="./vue.js"></script>

<script>
    var myTableComponent = Vue.extend({
        template: "#my-table",
        props: ['tableHead', 'tableBody']
    })

    var myBookComponent = Vue.extend({
        template: "#my-book",
        data() {
            return {
                bookHead: {author:'作者', name:'书名', price:'价格', publishDate:'出版日期'},
                books: [{
                    id: 1,
                    author: '曹雪芹',
                    name: '红楼梦',
                    price: 32.0,
                    publishDate:'1300-01-01'
                }, {
                    id: 2,
                    author: '施耐庵',
                    name: '水浒传',
                    price: 30.0,
                    publishDate:'1900-01-01'
                }, {
                    id: 3,
                    author: '罗贯中',
                    name: '三国演义',
                    price: 24.0,
                    publishDate:'1700-01-01'
                }, {
                    id: 4,
                    author: '吴承恩',
                    name: '西游记',
                    price: 20.0,
                    publishDate:'1500-01-01'
                }]
            }
        },
        components:{
            'my-table-component1': myTableComponent
        },
        methods: {
            delBook(obj) {
                this.books.forEach((book, index) => {
                    if(book.id == obj.id){
                        this.books.splice(index, 1)
                    }
                });
            }
        }
    })

    var myAddressComponent = Vue.extend({
        template: "#my-address",
        data() {
            return {
                addressHead: {author:'收货人', address:'地址', phone:'电话'},
                address: [{
                    id: 1,
                    author: '曹雪芹',
                    address: '广东省广州市从化区经济开发区高技术产业园广从南路548号',
                    phone: '138123456'
                }, {
                    id: 2,
                    author: '施耐庵',
                    address: '广东省广州市从化区经济开发区高技术产业园广从南路548号',
                    phone: '138123456'
                }, {
                    id: 3,
                    author: '罗贯中',
                    address: '广东省广州市从化区经济开发区高技术产业园广从南路548号',
                    phone: '138123456'
                }, {
                    id: 4,
                    author: '吴承恩',
                    address: '广东省广州市从化区经济开发区高技术产业园广从南路548号',
                    phone: '138123456'
                }]
            }
        },
        components:{
            'my-table-component2': myTableComponent
        },
        methods: {
            delAddress(obj) {
                this.address.forEach((address, index) => {
                    if(address.id == obj.id){
                        this.address.splice(index, 1)
                    }
                });
            }
        }
    })

    var vmContent = new Vue({
        el: '#content',
        data: {
            showCom: 'my-book'
        },
        components: {
            'my-book': myBookComponent,
            'my-address': myAddressComponent
        },
        methods: {
            menuAction(menuIndex) {
                if(menuIndex == 1) {
                    this.showCom = 'my-book'
                }else if(menuIndex == 2) {
                    this.showCom = 'my-address'
                }
            }
        }
    })
</script>
</html>